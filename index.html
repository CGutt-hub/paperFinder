<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paper Finder | 5ha99y</title>
    <meta name="description" content="AI-powered academic paper search with Zotero integration.">
    <link rel="stylesheet" href="https://cgutt-hub.github.io/5ha99y/style.css">
    <style>
/* Paper Finder - Tool-Specific Styles */

/* Search Interface */
.search-row {
    display: flex;
    gap: 0.75rem;
    align-items: center;
}

.search-row input {
    flex: 1;
}

.search-row button {
    white-space: nowrap;
}

.filters-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.checkbox-row {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
}

.checkbox-row label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: var(--font-size-sm);
    color: var(--text-secondary);
    cursor: pointer;
}

.checkbox-row label:hover {
    color: var(--text-primary);
}

.checkbox-row input[type="checkbox"] {
    width: 16px;
    height: 16px;
    accent-color: var(--accent-primary);
}

/* Status Bar */
.status-bar {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border-primary);
    border-radius: 6px;
    margin-bottom: 1.5rem;
    font-size: var(--font-size-sm);
}

.spinner {
    width: 16px;
    height: 16px;
    border: 2px solid var(--border-primary);
    border-top-color: var(--accent-primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Results Section */
.results-section {
    margin-top: 2rem;
}

.results-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border-primary);
    flex-wrap: wrap;
    gap: 1rem;
}

.results-header h2 {
    font-size: var(--font-size-lg);
    font-weight: 500;
    margin: 0;
    text-transform: lowercase;
}

#results-count {
    color: var(--text-muted);
    font-weight: 400;
}

.results-actions {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.results-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

/* Paper Card */
.paper-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-primary);
    border-radius: 8px;
    padding: 1.5rem;
    transition: all var(--transition-normal);
    cursor: pointer;
}

.paper-card:hover {
    border-color: var(--accent-primary);
    box-shadow: var(--shadow-md);
}

.paper-card.selected {
    border-color: var(--accent-primary);
    background: var(--accent-subtle);
}

.paper-header {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
}

.paper-checkbox {
    flex-shrink: 0;
    width: 18px;
    height: 18px;
    accent-color: var(--accent-primary);
    margin-top: 2px;
}

.paper-content {
    flex: 1;
    min-width: 0;
}

.paper-title {
    font-size: var(--font-size-base);
    font-weight: 600;
    margin-bottom: 0.5rem;
    line-height: 1.4;
    color: var(--text-primary);
}

.paper-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem 1rem;
    font-size: var(--font-size-sm);
    color: var(--text-muted);
    margin-bottom: 0.5rem;
}

.paper-meta-item {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.paper-authors {
    font-size: var(--font-size-sm);
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
}

.paper-abstract {
    font-size: var(--font-size-sm);
    color: var(--text-muted);
    line-height: 1.6;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.paper-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.75rem;
}

.paper-tag {
    font-size: var(--font-size-xs);
    color: var(--text-muted);
    background: var(--bg-tertiary);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
}

.paper-score {
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0.5rem;
    background: var(--bg-tertiary);
    border-radius: 6px;
    min-width: 50px;
}

.paper-score-value {
    font-size: var(--font-size-lg);
    font-weight: 600;
    color: var(--accent-primary);
}

.paper-score-label {
    font-size: var(--font-size-xs);
    text-transform: lowercase;
    color: var(--text-muted);
}

/* Empty State */
#empty-state {
    text-align: center;
    padding: 3rem 0;
}

.example-buttons {
    margin-top: 2rem;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.75rem;
}

.tag {
    padding: 0.5rem 1rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border-primary);
    border-radius: 6px;
    color: var(--text-secondary);
    font-family: var(--font-mono);
    font-size: var(--font-size-sm);
    cursor: pointer;
    transition: all var(--transition-fast);
    text-transform: lowercase;
}

.tag:hover {
    border-color: var(--accent-primary);
    color: var(--accent-primary);
}

/* Modals */
.modal-large {
    max-width: 700px;
}

#settings-status {
    padding: 0.75rem;
    border-radius: 6px;
    font-size: var(--font-size-sm);
    display: none;
}

#settings-status.success {
    display: block;
    background: rgba(39, 201, 63, 0.1);
    border-left: 3px solid #27c93f;
    color: #27c93f;
}

#settings-status.error {
    display: block;
    background: rgba(248, 81, 73, 0.1);
    border-left: 3px solid #f85149;
    color: #f85149;
}

#paper-modal-body {
    max-height: 60vh;
    overflow-y: auto;
}

#paper-modal-body h3 {
    font-size: var(--font-size-base);
    margin-top: 1.5rem;
    margin-bottom: 0.5rem;
}

#paper-modal-body p {
    margin-bottom: 1rem;
    line-height: 1.6;
}

#paper-modal-body .paper-meta {
    margin-bottom: 1rem;
}

/* Responsive */
@media (max-width: 768px) {
    .search-row {
        flex-direction: column;
    }
    
    .search-row button {
        width: 100%;
    }
    
    .filters-grid {
        grid-template-columns: 1fr;
    }
    
    .results-header {
        flex-direction: column;
        align-items: stretch;
    }
    
    .results-actions {
        justify-content: center;
    }
    
    .paper-header {
        flex-direction: column;
    }
    
    .paper-score {
        flex-direction: row;
        width: 100%;
        justify-content: center;
        gap: 0.5rem;
    }
}

@media (max-width: 480px) {
    .checkbox-row {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .example-buttons {
        flex-direction: column;
    }
    
    .tag {
        width: 100%;
        text-align: center;
    }
}
    </style>
    <script>
        // System theme detection - runs before render to prevent flash
        (function() {
            const saved = localStorage.getItem('theme');
            if (saved) {
                document.documentElement.setAttribute('data-theme', saved);
            } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
                document.documentElement.setAttribute('data-theme', 'light');
            } else {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        })();
    </script>
</head>
<body>
    <!-- Header loaded from 5ha99y -->
    <div id="header-placeholder"></div>
    
    <!-- Settings button for this tool -->
    <div style="position: fixed; top: 1rem; right: 4.5rem; z-index: 1000;">
        <button id="settings-btn" class="theme-switch" title="Settings">‚öôÔ∏è</button>
    </div>

    <main>
        <div class="content">

            <h2>About Paper Finder</h2>
            <p>
                Paper Finder is an AI-powered academic paper search tool that helps you discover, download, and organize scientific literature from multiple sources, including Semantic Scholar and arXiv. It supports advanced search queries, citation export, and batch downloads for efficient research workflows.
            </p>
            <ul>
                <li><strong>Features:</strong>
                    <ul>
                        <li>Search across multiple academic databases</li>
                        <li>Download papers in PDF format</li>
                        <li>Export citations to Zotero, BibTeX, and JSON</li>
                        <li>Batch search and download for large queries</li>
                        <li>Open access and privacy-respecting</li>
                    </ul>
                </li>
                <li><strong>How it works:</strong>
                    <ul>
                        <li>Enter your search query and select sources</li>
                        <li>Paper Finder uses academic APIs to find relevant papers</li>
                        <li>Results are shown with download and export options</li>
                    </ul>
                </li>
                <li><strong>Saving results:</strong>
                    <ul>
                        <li>Downloaded papers are saved to your chosen folder</li>
                        <li>Citations are exported as .bib, .json, or directly to Zotero</li>
                        <li>Search history and results can be exported for later use</li>
                    </ul>
                </li>
            </ul>

            <h1>Paper Finder</h1>
            <p>Search academic papers with AI-powered semantic ranking. Filter by year, citations, fields of study. Export directly to Zotero.</p>

            <!-- Search -->
            <div class="card">
                <div class="form-group">
                    <label for="search-input">Search Query</label>
                    <div class="search-row">
                        <input type="text" id="search-input" placeholder="describe your research interest...">
                        <button type="button" id="search-btn">Search</button>
                    </div>
                </div>

                <details>
                    <summary>Advanced Filters</summary>
                    <div class="filters-grid">
                        <div class="form-group">
                            <label for="year-start">Year From</label>
                            <input type="number" id="year-start" placeholder="2020">
                        </div>
                        <div class="form-group">
                            <label for="year-end">Year To</label>
                            <input type="number" id="year-end" placeholder="2026">
                        </div>
                        <div class="form-group">
                            <label for="min-citations">Min Citations</label>
                            <input type="number" id="min-citations" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="max-results">Max Results</label>
                            <input type="number" id="max-results" value="30">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Sources</label>
                        <div class="checkbox-row">
                            <label><input type="checkbox" id="source-ss" checked> Semantic Scholar</label>
                            <label><input type="checkbox" id="source-arxiv" checked> arXiv</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Options</label>
                        <div class="checkbox-row">
                            <label><input type="checkbox" id="pdf-only"> PDF only</label>
                            <label><input type="checkbox" id="ai-rank" checked> AI ranking ‚ú®</label>
                            <label><input type="checkbox" id="ai-refine"> AI query expansion ‚ú®</label>
                        </div>
                    </div>
                </details>
            </div>

            <!-- Status -->
            <div id="status-bar" class="status-bar hidden">
                <span class="spinner"></span> <span id="status-text">Searching...</span>
            </div>

            <!-- Results -->
            <section id="results-section" class="hidden">
                <div class="results-header">
                    <h2>Results <span id="results-count"></span></h2>
                    <div class="results-actions">
                        <button id="select-all-btn">Select All</button>
                        <button id="export-zotero-btn" disabled>üìö Zotero</button>
                        <button id="export-bibtex-btn">üìÑ BibTeX</button>
                        <button id="export-json-btn">üíæ JSON</button>
                    </div>
                </div>
                <div id="results-list"></div>
            </section>

            <!-- Empty state -->
            <section id="empty-state">
                <h3>Try searching for:</h3>
                <div class="example-buttons">
                    <button class="tag" data-query="transformer attention mechanisms">Transformers</button>
                    <button class="tag" data-query="brain-computer interface EEG">BCI & EEG</button>
                    <button class="tag" data-query="embodied cognition consciousness">Embodied Cognition</button>
                    <button class="tag" data-query="federated learning privacy">Federated Learning</button>
                </div>
            </section>
        </div>
    </main>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" id="settings-close">√ó</button>
            </div>
            <div class="modal-body">
                <blockquote>API keys are stored only in your browser. They are never sent anywhere except the respective API endpoints.</blockquote>

                <h3>OpenAI (optional)</h3>
                <p>Enables AI-powered ranking and query expansion.</p>
                <div class="form-group">
                    <label for="openai-key">API Key</label>
                    <input type="password" id="openai-key" placeholder="sk-...">
                </div>

                <h3>Zotero (optional)</h3>
                <p>Enables direct export to your library.</p>
                <div class="form-group">
                    <label for="zotero-key">API Key</label>
                    <input type="password" id="zotero-key" placeholder="Zotero API key">
                </div>
                <div class="form-group">
                    <label for="zotero-user">User ID</label>
                    <input type="text" id="zotero-user" placeholder="Numeric user ID">
                </div>

                <div id="settings-status"></div>
            </div>
            <div class="modal-footer">
                <button id="settings-save" type="submit">Save</button>
            </div>
        </div>
    </div>

    <!-- Paper Modal -->
    <div id="paper-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="paper-modal-title">Paper Details</h2>
                <button class="modal-close" id="paper-close">√ó</button>
            </div>
            <div class="modal-body" id="paper-modal-body"></div>
            <div class="modal-footer">
                <button id="paper-add-zotero" type="submit">üìö Add to Zotero</button>
                <a id="paper-pdf-link" href="#" target="_blank">üìÑ PDF</a>
                <a id="paper-link" href="#" target="_blank">üîó Source</a>
            </div>
        </div>
    </div>

    <!-- Footer loaded from 5ha99y -->
    <div id="footer-placeholder"></div>

    <script>
        // Load header and footer from 5ha99y
        async function loadComponent(url, elementId) {
            try {
                const response = await fetch(url);
                if (response.ok) {
                    const html = await response.text();
                    document.getElementById(elementId).innerHTML = html;
                }
            } catch (error) {
                console.warn(`Failed to load ${url}:`, error);
            }
        }
        
        // Load components on page load
        loadComponent('https://cgutt-hub.github.io/5ha99y/header.html', 'header-placeholder');
        loadComponent('https://cgutt-hub.github.io/5ha99y/footer.html', 'footer-placeholder');

        
        // Settings modal
        document.getElementById('settings-btn').addEventListener('click', () => {
            document.getElementById('settings-modal').classList.remove('hidden');
        });
        document.getElementById('settings-close').addEventListener('click', () => {
            document.getElementById('settings-modal').classList.add('hidden');
        });
        document.getElementById('settings-modal').querySelector('.modal-backdrop').addEventListener('click', () => {
            document.getElementById('settings-modal').classList.add('hidden');
        });

        // Example search buttons
        document.querySelectorAll('[data-query]').forEach(btn => {
            btn.addEventListener('click', () => {
                document.getElementById('search-input').value = btn.dataset.query;
                document.getElementById('search-btn').click();
            });
        });
    </script>
    <script src="app.js" type="module"></script>
</body>
</html>
