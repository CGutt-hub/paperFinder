<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paper Finder | 5ha99y</title>
    <meta name="description" content="AI-powered academic paper search with Zotero integration.">
    <link rel="stylesheet" href="https://cgutt-hub.github.io/5ha99y/style.css">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // System theme detection - runs before render to prevent flash
        (function() {
            const saved = localStorage.getItem('theme');
            if (saved) {
                document.documentElement.setAttribute('data-theme', saved);
            } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
                document.documentElement.setAttribute('data-theme', 'light');
            } else {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        })();
    </script>
</head>
<body>
    <!-- Header loaded from 5ha99y -->
    <div id="header-placeholder"></div>
    
    <!-- Settings button for this tool -->
    <div style="position: fixed; top: 1rem; right: 4.5rem; z-index: 1000;">
        <button id="settings-btn" class="theme-switch" title="Settings">‚öôÔ∏è</button>
    </div>

    <main>
        <div class="content">

            <h2>About Paper Finder</h2>
            <p>
                Paper Finder is an AI-powered academic paper search tool that helps you discover, download, and organize scientific literature from multiple sources, including Semantic Scholar, arXiv, and SearXNG. It supports advanced search queries, citation export, and batch downloads for efficient research workflows.
            </p>
            <ul>
                <li><strong>Features:</strong>
                    <ul>
                        <li>Search across multiple databases and the web</li>
                        <li>Download papers in PDF format</li>
                        <li>Export citations to Zotero, BibTeX, and JSON</li>
                        <li>Batch search and download for large queries</li>
                        <li>Open access and privacy-respecting</li>
                    </ul>
                </li>
                <li><strong>How it works:</strong>
                    <ul>
                        <li>Enter your search query and select sources</li>
                        <li>Paper Finder uses APIs and SearXNG to find relevant papers</li>
                        <li>Results are shown with download and export options</li>
                    </ul>
                </li>
                <li><strong>Saving results:</strong>
                    <ul>
                        <li>Downloaded papers are saved to your chosen folder</li>
                        <li>Citations are exported as .bib, .json, or directly to Zotero</li>
                        <li>Search history and results can be exported for later use</li>
                    </ul>
                </li>
            </ul>

            <h1>Paper Finder</h1>
            <p>Search academic papers with AI-powered semantic ranking. Filter by year, citations, fields of study. Export directly to Zotero.</p>

            <!-- Search -->
            <div class="card">
                <div class="form-group">
                    <label for="search-input">Search Query</label>
                    <div class="search-row">
                        <input type="text" id="search-input" placeholder="describe your research interest...">
                        <button type="button" id="search-btn">Search</button>
                    </div>
                </div>

                <details>
                    <summary>Advanced Filters</summary>
                    <div class="filters-grid">
                        <div class="form-group">
                            <label for="year-start">Year From</label>
                            <input type="number" id="year-start" placeholder="2020">
                        </div>
                        <div class="form-group">
                            <label for="year-end">Year To</label>
                            <input type="number" id="year-end" placeholder="2026">
                        </div>
                        <div class="form-group">
                            <label for="min-citations">Min Citations</label>
                            <input type="number" id="min-citations" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="max-results">Max Results</label>
                            <input type="number" id="max-results" value="30">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Sources</label>
                        <div class="checkbox-row">
                            <label><input type="checkbox" id="source-ss" checked> Semantic Scholar</label>
                            <label><input type="checkbox" id="source-arxiv" checked> arXiv</label>
                            <label><input type="checkbox" id="source-searxng"> SearXNG</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Options</label>
                        <div class="checkbox-row">
                            <label><input type="checkbox" id="pdf-only"> PDF only</label>
                            <label><input type="checkbox" id="ai-rank" checked> AI ranking ‚ú®</label>
                            <label><input type="checkbox" id="ai-refine"> AI query expansion ‚ú®</label>
                        </div>
                    </div>
                </details>
            </div>

            <!-- Status -->
            <div id="status-bar" class="status-bar hidden">
                <span class="spinner"></span> <span id="status-text">Searching...</span>
            </div>

            <!-- Results -->
            <section id="results-section" class="hidden">
                <div class="results-header">
                    <h2>Results <span id="results-count"></span></h2>
                    <div class="results-actions">
                        <button id="select-all-btn">Select All</button>
                        <button id="export-zotero-btn" disabled>üìö Zotero</button>
                        <button id="export-bibtex-btn">üìÑ BibTeX</button>
                        <button id="export-json-btn">üíæ JSON</button>
                    </div>
                </div>
                <div id="results-list"></div>
            </section>

            <!-- Empty state -->
            <section id="empty-state">
                <h3>Try searching for:</h3>
                <div class="example-buttons">
                    <button class="tag" data-query="transformer attention mechanisms">Transformers</button>
                    <button class="tag" data-query="brain-computer interface EEG">BCI & EEG</button>
                    <button class="tag" data-query="embodied cognition consciousness">Embodied Cognition</button>
                    <button class="tag" data-query="federated learning privacy">Federated Learning</button>
                </div>
            </section>
        </div>
    </main>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" id="settings-close">√ó</button>
            </div>
            <div class="modal-body">
                <blockquote>API keys are stored only in your browser. They are never sent anywhere except the respective API endpoints.</blockquote>

                <h3>OpenAI (optional)</h3>
                <p>Enables AI-powered ranking and query expansion.</p>
                <div class="form-group">
                    <label for="openai-key">API Key</label>
                    <input type="password" id="openai-key" placeholder="sk-...">
                </div>

                <h3>Zotero (optional)</h3>
                <p>Enables direct export to your library.</p>
                <div class="form-group">
                    <label for="zotero-key">API Key</label>
                    <input type="password" id="zotero-key" placeholder="Zotero API key">
                </div>
                <div class="form-group">
                    <label for="zotero-user">User ID</label>
                    <input type="text" id="zotero-user" placeholder="Numeric user ID">
                </div>

                <h3>SearXNG (optional)</h3>
                <p>Use your own instance for broader web search (Google Scholar, PubMed, BASE, etc).</p>
                <div class="form-group">
                    <label for="searxng-url">Instance URL</label>
                    <input type="url" id="searxng-url" placeholder="https://searx.example.com">
                </div>

                <div id="settings-status"></div>
            </div>
            <div class="modal-footer">
                <button id="settings-save" type="submit">Save</button>
            </div>
        </div>
    </div>

    <!-- Paper Modal -->
    <div id="paper-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 id="paper-modal-title">Paper Details</h2>
                <button class="modal-close" id="paper-close">√ó</button>
            </div>
            <div class="modal-body" id="paper-modal-body"></div>
            <div class="modal-footer">
                <button id="paper-add-zotero" type="submit">üìö Add to Zotero</button>
                <a id="paper-pdf-link" href="#" target="_blank">üìÑ PDF</a>
                <a id="paper-link" href="#" target="_blank">üîó Source</a>
            </div>
        </div>
    </div>

    <!-- Footer loaded from 5ha99y -->
    <div id="footer-placeholder"></div>

    <script>
        // Load header and footer from 5ha99y
        async function loadComponent(url, elementId) {
            try {
                const response = await fetch(url);
                if (response.ok) {
                    const html = await response.text();
                    document.getElementById(elementId).innerHTML = html;
                }
            } catch (error) {
                console.warn(`Failed to load ${url}:`, error);
            }
        }
        
        // Load components on page load
        loadComponent('https://cgutt-hub.github.io/5ha99y/header.html', 'header-placeholder');
        loadComponent('https://cgutt-hub.github.io/5ha99y/footer.html', 'footer-placeholder');

        
        // Settings modal
        document.getElementById('settings-btn').addEventListener('click', () => {
            document.getElementById('settings-modal').classList.remove('hidden');
        });
        document.getElementById('settings-close').addEventListener('click', () => {
            document.getElementById('settings-modal').classList.add('hidden');
        });
        document.getElementById('settings-modal').querySelector('.modal-backdrop').addEventListener('click', () => {
            document.getElementById('settings-modal').classList.add('hidden');
        });

        // Example search buttons
        document.querySelectorAll('[data-query]').forEach(btn => {
            btn.addEventListener('click', () => {
                document.getElementById('search-input').value = btn.dataset.query;
                document.getElementById('search-btn').click();
            });
        });
    </script>
    <script src="app.js" type="module"></script>
</body>
</html>
